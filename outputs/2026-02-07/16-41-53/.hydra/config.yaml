model:
  name: dit_b2
  vision:
    model_name: dinov2_vitl14
    image_size: 224
    patch_size: 14
    hidden_dim: 1024
    freeze: true
    output_tokens: all
  language:
    model_name: openai/clip-vit-large-patch14
    hidden_dim: 1024
    max_length: 77
    freeze: true
    pooling: eos
  fusion:
    hidden_dim: 768
    num_heads: 12
    num_layers: 2
    dropout: 0.0
    use_rope: true
    qk_norm: true
  transformer:
    hidden_dim: 768
    num_heads: 12
    num_layers: 12
    mlp_ratio: 4.0
    dropout: 0.0
    use_rope: true
    use_qk_norm: true
    use_swiglu: true
    use_flash_attn: true
    conditioning_dim: 768
  action_decoder:
    hidden_dim: 768
    action_horizon: 16
    position_dim: 3
    rotation_dim: 4
    gripper_dim: 1
    num_layers: 2
    dropout: 0.0
    action_scale: 1.0
  hidden_dim: 768
  action_horizon: 16
  noise_dim: 64
  cfg_scale_range:
  - 1.0
  - 4.0
  cfg_dropout: 0.1
training:
  learning_rate: 0.0004
  weight_decay: 0.05
  warmup_steps: 1000
  max_steps: 100000
  grad_clip: 2.0
  grad_accumulation_steps: 1
  batch_size: 32
  num_workers: 4
  ema_decay: 0.9999
  ema_warmup_steps: 1000
  drifting:
    temperatures:
    - 0.02
    - 0.05
    - 0.2
    normalize_features: true
    normalize_drift: true
    n_pos_samples: 32
    n_neg_samples: 32
  use_amp: true
  amp_dtype: bfloat16
  use_fsdp: true
  fsdp_shard_size: 100000000
  checkpoint_dir: ./checkpoints
  save_every_n_steps: 5000
  keep_last_n_checkpoints: 5
  log_every_n_steps: 100
  eval_every_n_steps: 1000
  wandb:
    project: drifting-vla
    entity: null
    mode: online
    tags:
    - baseline
    log_images: true
    log_videos: true
    theme: light
    visualizations:
      drifting_field:
        enabled: true
        frequency: 500
        num_samples: 100
      drift_trend:
        frequency: 200
      prediction_scatter:
        frequency: 500
      error_radar:
        frequency: 500
      temperature_loss:
        frequency: 500
      action_distribution:
        enabled: true
        frequency: 500
      error_heatmap:
        frequency: 500
      trajectory_3d:
        enabled: true
        frequency: 1000
      sample_transport:
        frequency: 500
      mode_coverage:
        frequency: 2000
  simulation_eval:
    enabled: true
    num_episodes: 3
    max_steps: 100
    tasks:
    - close_jar
    record_video: true
    video_fps: 10
    eval_freq: 5000
    use_dummy_env: false
data:
  data_dir: ./data/rlbench
  tasks:
  - close_jar
  cameras:
  - front
  sample_queue:
    queue_size: 128
